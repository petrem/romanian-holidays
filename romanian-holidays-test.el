;;; romanian-holidays-test.el --- Tests for orthodox easter calculation  -*- lexical-binding: t; -*-

;;; Commentary:

;;; Code:

(load-file "romanian-holidays.el")
(declare-function romanian-holidays--holiday-orthodox-easter-etc "romanian-holidays.el" (n string))

(defun set-displayed-date (day)
  "Simulate calendar for the 1st day of the year and month given as DAY."
  (setq displayed-year (calendar-extract-year day)
        displayed-month (calendar-extract-month day)
        displayed-day 1))


(ert-deftest easter-dates-around-2024 ()
  ;; Dates from https://en.wikipedia.org/wiki/List_of_dates_for_Easter
  (setq easter-dates '((4 12 2015)
                       (5  1 2016)
                       (4 16 2017)
                       (4  8 2018)
                       (4 28 2019)
                       (4 19 2020)
                       (5  2 2021)
                       (4 24 2022)
                       (4 16 2023)
                       (5  5 2024)
                       (4 20 2025)
                       (4 12 2026)
                       (5  2 2027)
                       (4 16 2028)
                       (4  8 2029)
                       (4 28 2030)))
  (dolist (ed easter-dates nil)
    (set-displayed-date ed)
    (should (equal (list (list ed "foo")) (romanian-holidays--holiday-orthodox-easter-etc 0 "foo")))))


(ert-deftest easter-dates-random-years-between-1600-and-3000 ()
  ;; The easter dates were generated with python package `dateutil` and checked with
  ;; Haskell's `Data.Time.Calendar.Easter` from the `time` package.
  ;; Note the two seem to give different results for years below 1500 ish.
  (setq easter-dates '((4 14 1602)
                       (4 18 1604)
                       (4 30 1606)
                       (4  3 1611)
                       (4 15 1618)
                       (4 23 1623)
                       (4 19 1626)
                       (4  7 1630)
                       (4  8 1635)
                       (4 20 1642)
                       (4 12 1643)
                       (4  8 1646)
                       (4 13 1659)
                       (4 24 1661)
                       (4  9 1662)
                       (4 20 1664)
                       (4  5 1676)
                       (4 10 1678)
                       (4 30 1679)
                       (4 13 1681)
                       (4 14 1697)
                       (4 16 1702)
                       (5  5 1709)
                       (4 12 1711)
                       (5  2 1717)
                       (4 28 1720)
                       (4  5 1722)
                       (4 16 1724)
                       (4 17 1735)
                       (4 13 1738)
                       (4 17 1740)
                       (4  6 1749)
                       (4 14 1754)
                       (4 10 1757)
                       (4 26 1761)
                       (4 10 1768)
                       (4 30 1769)
                       (4  7 1771)
                       (4 11 1784)
                       (4 20 1800)
                       (4 25 1802)
                       (4 17 1803)
                       (4 29 1810)
                       (4 25 1813)
                       (4 30 1815)
                       (4 30 1826)
                       (4 15 1838)
                       (4  7 1844)
                       (4  4 1847)
                       (4 23 1848)
                       (4  8 1855)
                       (4 19 1857)
                       (5  1 1864)
                       (4 28 1867)
                       (4 12 1868)
                       (4 24 1870)
                       (4 28 1878)
                       (4  5 1885)
                       (4 29 1894)
                       (4 25 1897)
                       (4 14 1901)
                       (4 23 1911)
                       (4 15 1917)
                       (4 16 1922)
                       (4 19 1925)
                       (4 15 1928)
                       (5  1 1932)
                       (4 16 1933)
                       (4  8 1934)
                       (4 28 1935)
                       (4 20 1941)
                       (4 21 1946)
                       (4 26 1981)
                       (4 12 2015)
                       (5  1 2016)
                       (4  8 2018)
                       (4 24 2033)
                       (4 21 2047)
                       (4  5 2048)
                       (4 13 2064)
                       (4 10 2067)
                       (5  4 2070)
                       (4 12 2099)
                       (4  9 2102)
                       (4 20 2104)
                       (4  5 2105)
                       (4 25 2106)
                       (4 30 2119)
                       (4 14 2126)
                       (4  6 2132)
                       (4 30 2141)
                       (4  7 2143)
                       (4 18 2145)
                       (4 14 2148)
                       (5  4 2149)
                       (4 15 2153)
                       (4 15 2164)
                       (5  5 2165)
                       (4 16 2175)
                       (4 20 2177)
                       (4 26 2201)
                       (4 30 2209)
                       (4 11 2219)
                       (5  5 2222)
                       (5  1 2225)
                       (4 15 2232)
                       (5  5 2233)
                       (4 12 2235)
                       (4 16 2243)
                       (4 20 2245)
                       (4 17 2259)
                       (4 13 2262)
                       (5 10 2268)
                       (4  9 2276)
                       (4 29 2277)
                       (5  4 2290)
                       (4 30 2293)
                       (4 22 2294)
                       (4 15 2300)
                       (4 16 2305)
                       (4 24 2310)
                       (4 16 2311)
                       (5  5 2312)
                       (4 20 2313)
                       (4 12 2314)
                       (4 28 2318)
                       (4 29 2323)
                       (5 10 2325)
                       (5  3 2331)
                       (4 29 2334)
                       (4 18 2343)
                       (4 14 2346)
                       (4 23 2367)
                       (4 14 2368)
                       (4 11 2371)
                       (4 27 2380)
                       (4 19 2381)
                       (4 24 2383)
                       (4 12 2387)
                       (4 12 2398)
                       (4 28 2402)
                       (5  3 2415)
                       (4  9 2417)
                       (4 21 2419)
                       (5 10 2420)
                       (4 13 2425)
                       (5  3 2426)
                       (5  4 2431)
                       (4 30 2434)
                       (4 13 2436)
                       (4 10 2444)
                       (4 14 2452)
                       (5  4 2453)
                       (4 19 2454)
                       (4 30 2456)
                       (4 23 2462)
                       (4 15 2463)
                       (5  4 2464)
                       (5  1 2467)
                       (5  5 2469)
                       (4 12 2471)
                       (4 23 2473)
                       (5  2 2483)
                       (4 30 2502)
                       (4 29 2508)
                       (5  4 2521)
                       (4 23 2530)
                       (5  9 2534)
                       (5  1 2535)
                       (4 16 2547)
                       (4 12 2550)
                       (5  2 2551)
                       (4 20 2555)
                       (5  2 2562)
                       (5 10 2572)
                       (4 21 2582)
                       (5  3 2589)
                       (4 29 2592)
                       (4 17 2596)
                       (5  4 2600)
                       (5 13 2610)
                       (5  2 2619)
                       (5  3 2635)
                       (4 24 2636)
                       (4 21 2644)
                       (5  3 2646)
                       (5  7 2648)
                       (5  7 2654)
                       (5  4 2662)
                       (4 23 2671)
                       (4 26 2674)
                       (4 11 2675)
                       (4 18 2680)
                       (4 23 2682)
                       (5  5 2689)
                       (5 14 2705)
                       (4 21 2707)
                       (5 10 2708)
                       (5  7 2711)
                       (5  7 2716)
                       (5  3 2725)
                       (4 18 2726)
                       (5 12 2735)
                       (4 23 2739)
                       (5  4 2741)
                       (4 22 2745)
                       (5  8 2749)
                       (4 23 2750)
                       (4 15 2751)
                       (4 19 2764)
                       (4 20 2780)
                       (5  3 2787)
                       (4 29 2790)
                       (4 13 2797)
                       (4 18 2810)
                       (5 12 2819)
                       (4 22 2829)
                       (4 22 2840)
                       (4 19 2843)
                       (4 23 2845)
                       (5  9 2849)
                       (4 12 2854)
                       (5  6 2863)
                       (5 13 2868)
                       (4 20 2870)
                       (5  3 2871)
                       (5  6 2874)
                       (5  2 2877)
                       (4 16 2884)
                       (4 25 2888)
                       (4 17 2889)
                       (4 13 2892)
                       (5  8 2895)
                       (4 29 2896)
                       (4 15 2903)
                       (4 12 2911)
                       (4 27 2921)
                       (4 23 2924)
                       (5 10 2933)
                       (4 20 2938)
                       (4 24 2940)
                       (4 21 2943)
                       (4 28 2948)
                       (5  3 2950)
                       (5 11 2955)
                       (4 22 2959)
                       (4 26 2967)
                       (4 18 2973)
                       (5  8 2974)
                       (4 14 2976)
                       (5  4 2977)
                       (4 23 2986)
                       (4 26 2989)
                       (5  9 2990)
                       (4 22 2992)
                       (4 15 2998)))
  (dolist (ed easter-dates nil)
    (set-displayed-date ed)
    (should (equal (list (list ed "foo")) (romanian-holidays--holiday-orthodox-easter-etc 0 "foo")))))

(provide 'romanian-holidays-test)
;;; romanian-holidays-test.el ends here
